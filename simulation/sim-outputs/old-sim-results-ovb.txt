# B = 100 and only normal wald test
> sim.all.bootys
      accepts       p.vals within.ests pooled.ests            
 [1,]      77 3.210063e-01    1.677352    1.743848  5 0.6  100
 [2,]      39 9.691896e-02    1.684319    1.749483  5 0.6  500
 [3,]       3 7.274633e-03    1.683231    1.747028  5 0.6 1000
 [4,]      64 1.788880e-01    1.752637    1.938196  5 0.9  100
 [5,]       0 7.990202e-04    1.757619    1.938015  5 0.9  500
 [6,]       0 1.743784e-05    1.757495    1.936818  5 0.9 1000
 [7,]      55 1.869707e-01    1.701638    1.730950 10 0.6  100
 [8,]       5 1.307547e-02    1.707739    1.735006 10 0.6  500
 [9,]       0 7.545333e-06    1.705549    1.732825 10 0.6 1000
[10,]       5 1.274099e-02    1.822909    1.927291 10 0.9  100
[11,]       0 4.082304e-11    1.832615    1.927692 10 0.9  500
[12,]       0 0.000000e+00    1.831983    1.927806 10 0.9 1000

# B = 500 both wald and gen.wald tests (nperson = 5000, replace = TRUE)
> sim.results
      wald.accepts       p.vals gen.wald.accepts    gen.p.vals within.ests pooled.ests Tt rho.lag samplesize
 [1,]          390 2.921935e-01              419  3.251075e-01    1.685064    1.749889  5     0.6        100
 [2,]          100 4.156185e-02              165  6.463646e-02    1.688143    1.753163  5     0.6        500
 [3,]            5 3.629721e-03               19  8.165319e-03    1.688437    1.754641  5     0.6       1000
 [4,]          239 1.283404e-01              270  1.429608e-01    1.754846    1.932834  5     0.9        100
 [5,]            0 1.551656e-04                0  3.143238e-04    1.758196    1.932827  5     0.9        500
 [6,]            0 8.581544e-08                0  2.855317e-07    1.757688    1.933672  5     0.9       1000
 [7,]          318 2.079125e-01              453  3.596502e-01    1.712225    1.743860 10     0.6        100
 [8,]            7 3.820107e-03              222  7.290103e-02    1.708722    1.739787 10     0.6        500
 [9,]            0 9.675136e-06               15  8.887384e-03    1.710065    1.741398 10     0.6       1000
[10,]           25 1.047758e-02               64  2.377355e-02    1.836613    1.929554 10     0.9        100
[11,]            0 2.736731e-13                0  6.206939e-09    1.838389    1.929033 10     0.9        500
[12,]            0 0.000000e+00                0 -1.053731e-08    1.838925    1.929360 10     0.9       1000
# above accepts divided by B = 500 to get correct ratio
> cbind(sim.results[, 1] / 500, sim.results[, 2], sim.results[, 3] / 500, sim.results[, 4:9])
      wald.accepts       p.vals gen.wald.accepts    gen.p.vals within.ests pooled.ests Tt rho.lag samplesize
 [1,] 0.780        2.921935e-01            0.838  3.251075e-01    1.685064    1.749889  5     0.6        100
 [2,] 0.200        4.156185e-02            0.330  6.463646e-02    1.688143    1.753163  5     0.6        500
 [3,] 0.010        3.629721e-03            0.038  8.165319e-03    1.688437    1.754641  5     0.6       1000
 [4,] 0.478        1.283404e-01            0.540  1.429608e-01    1.754846    1.932834  5     0.9        100
 [5,] 0.000        1.551656e-04            0.000  3.143238e-04    1.758196    1.932827  5     0.9        500
 [6,] 0.000        8.581544e-08            0.000  2.855317e-07    1.757688    1.933672  5     0.9       1000
 [7,] 0.636        2.079125e-01            0.906  3.596502e-01    1.712225    1.743860 10     0.6        100
 [8,] 0.014        3.820107e-03            0.444  7.290103e-02    1.708722    1.739787 10     0.6        500
 [9,] 0.000        9.675136e-06            0.030  8.887384e-03    1.710065    1.741398 10     0.6       1000
[10,] 0.050        1.047758e-02            0.128  2.377355e-02    1.836613    1.929554 10     0.9        100
[11,] 0.000        2.736731e-13            0.000  6.206939e-09    1.838389    1.929033 10     0.9        500
[12,] 0.000        0.000000e+00            0.000 -1.053731e-08    1.838925    1.929360 10     0.9       1000


# B = 500, nperson = 5000, replace = FALSE
> tab.sim
      wald.accepts       p.vals gen.wald.accepts   gen.p.vals within.ests pooled.ests Tt rho.lag samplesize
 [1,]          365 2.837842e-01              428 3.287740e-01    1.695725    1.758635  5     0.6        100
 [2,]           89 3.803384e-02              161 6.843126e-02    1.698558    1.759191  5     0.6        500
 [3,]            1 9.011726e-04               10 5.198795e-03    1.697250    1.757944  5     0.6       1000
 [4,]          282 1.694674e-01              310 1.848106e-01    1.759417    1.930293  5     0.9        100
 [5,]           12 3.598081e-03               12 5.061838e-03    1.760848    1.932685  5     0.9        500
 [6,]            0 7.414539e-06                0 1.085939e-05    1.760527    1.931815  5     0.9       1000
 [7,]          322 2.130492e-01              463 3.635734e-01    1.697042    1.731467 10     0.6        100
 [8,]           29 1.176661e-02              273 1.027161e-01    1.694254    1.729468 10     0.6        500
 [9,]            1 2.798734e-04               43 1.943782e-02    1.693824    1.729069 10     0.6       1000
[10,]           26 1.094161e-02               73 2.685494e-02    1.831915    1.928565 10     0.9        100
[11,]            0 1.845191e-15                0 5.031562e-09    1.831953    1.928693 10     0.9        500
[12,]            0 0.000000e+00                0 5.230504e-09    1.832626    1.929068 10     0.9       1000
> tab.sim[, c(1,3)] / 500
      wald.accepts gen.wald.accepts
 [1,]        0.730            0.856
 [2,]        0.178            0.322
 [3,]        0.002            0.020
 [4,]        0.564            0.620
 [5,]        0.024            0.024
 [6,]        0.000            0.000
 [7,]        0.644            0.926
 [8,]        0.058            0.546
 [9,]        0.002            0.086
[10,]        0.052            0.146
[11,]        0.000            0.000
[12,]        0.000            0.000






# B = 100, nperson = 1000, replace = FALSE 
# denk dat dit geen goede simulatie is, omdat nperson = 1000 en als dat B.size = 1000 dan herhaal je precies
# dezelfde berekening B = 100 keer.
> sim.maybewrong
      wald.accepts       p.vals gen.wald.accepts    gen.p.vals within.ests pooled.ests Tt rho.lag samplesize
 [1,]           87 4.106087e-01               92  4.383251e-01    1.660335    1.739282  5     0.6        100
 [2,]           76 2.059528e-01               93  2.948370e-01    1.650645    1.741449  5     0.6        500
 [3,]            0 2.455717e-02              100  8.892269e-02    1.652451    1.741990  5     0.6       1000
 [4,]           46 1.087752e-01               57  1.295876e-01    1.760295    1.946632  5     0.9        100
 [5,]            0 9.110544e-06                0  3.891557e-05    1.763028    1.944015  5     0.9        500
 [6,]            0 2.886580e-15                0  3.953174e-06    1.764053    1.944297  5     0.9       1000
 [7,]           61 2.269096e-01               90  3.802664e-01    1.699491    1.735772 10     0.6        100
 [8,]            4 7.061727e-03               70  1.184357e-01    1.693666    1.733050 10     0.6        500
 [9,]            0 3.306744e-07                0  1.461559e-02    1.694485    1.732822 10     0.6       1000
[10,]            0 2.175153e-03               10  1.711559e-02    1.816260    1.935234 10     0.9        100
[11,]            0 0.000000e+00                0 -6.026071e-09    1.819090    1.933688 10     0.9        500
[12,]            0 0.000000e+00                0  6.882578e-08    1.818482    1.933711 10     0.9       1000


